---
name: doc-coauthoring
description: 指导用户通过结构化的工作流程进行文档协作写作。当用户想要编写文档、提案、技术规范、决策文档或类似的结构化内容时使用。此工作流程帮助用户有效地传递上下文、通过迭代完善内容，并验证文档对读者是否适用。当用户提到编写文档、创建提案、起草规范或类似文档任务时触发。
---

# 文档协作写作工作流程

此技能提供结构化工作流程，指导用户完成协作文档创作。作为主动引导者，引导用户完成三个阶段：上下文收集、完善与结构、以及读者测试。

## 何时提供此工作流程

**触发条件：**
- 用户提到编写文档："写文档"、"起草提案"、"创建规范"、"写下来"
- 用户提到特定的文档类型："PRD"、"设计文档"、"决策文档"、"RFC"
- 用户似乎正在开始一项重要的写作任务

**初始提议：**
向用户提议结构化的文档协作工作流程。解释三个阶段：

1. **上下文收集**：用户提供所有相关上下文，大型语言模型提出澄清问题
2. **完善与结构**：通过头脑风暴和编辑迭代构建每个部分
3. **读者测试**：用新的大型语言模型（无上下文）测试文档，以在其他读者阅读之前发现盲点

解释这种方法有助于确保文档在其他读者阅读时效果良好（包括当他们将其粘贴到大型语言模型中时）。询问他们是否想尝试这种工作流程，还是更喜欢自由形式工作。

如果用户拒绝，则自由形式工作。如果用户接受，则进入阶段1。

## 阶段1：上下文收集

**目标：** 缩小用户知道的内容与大型语言模型知道的内容之间的差距，以便之后能够提供智能指导。

### 初始问题

首先向用户询问关于文档的元上下文：

1. 这是什么类型的文档？（例如，技术规范、决策文档、提案）
2. 主要受众是谁？
3. 当有人阅读时，期望产生什么影响？
4. 是否需要遵循特定模板或格式？
5. 还有什么其他约束或上下文需要了解？

告知他们可以使用简写或以最适合他们的方式倾倒信息。

**如果用户提供模板或提到文档类型：**
- 询问他们是否有模板文档可以分享
- 如果他们提供共享文档的链接，使用适当的集成来获取它
- 如果他们提供文件，则读取它

**如果用户提到编辑现有的共享文档：**
- 使用适当的集成来读取当前状态
- 检查没有alt文本的图片
- 如果存在没有alt文本的图片，解释当其他人使用大型语言模型理解文档时，大型语言模型将无法看到它们。询问他们是否要生成alt文本。如果是，要求他们将每张图片粘贴到聊天中以生成描述性alt文本。

### 信息倾倒

一旦初始问题得到回答，鼓励用户倾倒他们拥有的所有上下文。请求提供以下信息：
- 项目/问题的背景
- 相关的团队讨论或共享文档
- 为什么不使用替代解决方案
- 组织背景（团队动态、過去事件、政治）
- 时间线压力或约束
- 技术架构或依赖关系
- 利益相关者的担忧

建议他们不要担心组织问题——只需全部倾倒出来。提供多种提供上下文的方式：
- 信息倾倒式自由联想
- 指向团队频道或线程进行阅读
- 链接到共享文档

**如果集成可用**（例如Slack、Teams、Google Drive、SharePoint或其他MCP服务器），提到这些可用于直接拉取上下文。

**如果未检测到集成且在大型语言模型.ai或大型语言模型应用中：** 建议他们可以在大型语言模型设置中启用连接器，以允许直接从消息应用和文档存储拉取上下文。

告知他们完成初始倾倒后会提出澄清问题。

**在上下文收集期间：**

- 如果用户提到团队频道或共享文档：
  - 如果集成可用：告知他们内容现在将被读取，然后使用适当的集成
  - 如果集成不可用：解释缺乏访问权限。建议他们在大型语言模型设置中启用连接器，或直接粘贴相关内容。

- 如果用户提到未知的实体/项目：
  - 询问是否应该搜索连接的工具有更多信息
  - 在搜索之前等待用户确认

- 当用户提供上下文时，跟踪已学到的内容和仍不清楚的内容

**提出澄清问题：**

当用户表示已完成初始倾倒（或提供了大量上下文后），提出澄清问题以确保理解：

根据上下文中的差距生成5-10个编号问题。

告知他们可以使用简写回答（例如，"1：是的，2：见#频道，3：不，因为向后兼容"），链接到更多文档，指向要阅读的频道，或继续信息倾倒。无论什么对他们来说最有效。

**退出条件：**
当问题显示理解时——当可以在不需要解释基础的情况下询问边缘情况和权衡时，就收集到了足够的上下文。

**过渡：**
询问他们是否想在此阶段提供更多上下文，还是开始起草文档。

如果用户想添加更多，让他们添加。准备就绪后，进入阶段2。

## 阶段2：完善与结构

**目标：** 通过头脑风暴、筛选和迭代完善逐节构建文档。

**对用户的说明：**
解释文档将逐节构建。对于每个部分：
1. 将提出关于包含内容的澄清问题
2. 将进行5-20个选项的头脑风暴
3. 用户将指示保留/删除/合并什么
4. 将起草该部分
5. 将通过精确编辑进行完善

从未知内容最多的部分开始（通常是核心决策/提案），然后处理其余部分。

**部分排序：**

如果文档结构清晰：
询问他们想从哪个部分开始。

建议从未知内容最多的部分开始。对于决策文档，通常是核心提案。对于规范，通常是技术方法。摘要部分最好留到最后。

如果用户不知道他们需要哪些部分：
根据文档类型和模板，建议3-5个适合该文档类型的部分。

询问这个结构是否可行，或者他们想要调整。

**一旦结构达成一致：**

创建所有部分带有占位符文本的初始文档结构。

**如果可以访问工件：**
使用`create_file`创建一个工件。这为大型语言模型和用户都提供了一个脚手架。

告知他们将创建带有所有部分占位符的初始结构。

创建包含所有部分标题和简短占位符文本（如"[待编写]"或"[此处内容]"）的工件。

提供脚手架链接，并表明是时候填充每个部分了。

**如果没有访问工件的权限：**
在工作目录中创建一个markdown文件。适当命名（例如`decision-doc.md`、`technical-spec.md`）。

告知他们将创建带有所有部分占位符的初始结构。

创建包含所有部分标题和占位符文本的文件。

确认文件名已创建，并表明是时候填充每个部分了。

**对于每个部分：**

### 第1步：澄清问题

宣布开始处理[部分名称]部分。提出5-10个关于应该包含什么内容的澄清问题：

根据上下文和部分目的生成5-10个具体问题。

告知他们可以使用简写或只指出重要的是什么。

### 第2步：头脑风暴

对于[部分名称]部分，根据部分的复杂性头脑风暴[5-20]个可能包含的内容。寻找：
- 可能被遗忘的共享上下文
- 尚未提及的角度或考虑因素

根据部分复杂性生成5-20个编号选项。最后，如果他们想要更多选项，提供更多头脑风暴。

### 第3步：筛选

询问哪些要点应该保留、删除或合并。要求简要说明以帮助了解下一个部分的优先级。

提供示例：
- "保留1,4,7,9"
- "删除3（与1重复）"
- "删除6（读者已经知道）"
- "合并11和12"

**如果用户给出自由形式的反馈**（例如"看起来不错"或"我喜欢大部分，但..."）而不是编号选择，提取他们的偏好并继续。解析他们想要保留/删除/更改的内容并应用它。

### 第4步：差距检查

根据他们选择的内容，询问[部分名称]部分是否遗漏了什么重要的内容。

### 第5步：起草

使用`str_replace`将此部分的占位符文本替换为实际起草的内容。

宣布现在将根据他们选择的内容起草[部分名称]部分。

**如果使用工件：**
起草后，提供工件的链接。

要求他们阅读并指出要更改什么。注意具体性有助于下一个部分的学习。

**如果使用文件（没有工件）：**
起草后，确认完成。

告知他们[部分名称]部分已在[文件名]中起草。让他们阅读并指出要更改什么。注意具体性有助于下一个部分的学习。

**对用户的关键说明（在起草第一部分时包括）：**
提供一个注释：不要直接编辑文档，而是让他们指出要更改什么。这有助于学习他们未来的风格。例如："删除第三段——已经由Y涵盖"或"使第三段更简洁"。

### 第6步：迭代完善

当用户提供反馈时：
- 使用`str_replace`进行编辑（永远不要重新打印整个文档）
- **如果使用工件：** 每次编辑后提供工件链接
- **如果使用文件：** 只确认编辑完成
- 如果用户直接编辑文档并要求阅读：心理记录他们所做的更改，并在处理后续部分时记住它们（这显示了他们的偏好）

**继续迭代**，直到用户对该部分满意。

### 质量检查

连续3次迭代没有实质性更改后，询问是否可以删除任何内容而不丢失重要信息。

当部分完成时，确认[部分名称]完成。询问是否准备好进入下一部分。

**对所有部分重复此过程。**

### 接近完成

当接近完成（80%以上的部分完成）时，宣布打算重新阅读整个文档并检查：
- 各部分之间的流程和一致性
- 冗余或矛盾
- 任何感觉像"垃圾"或通用填充物的地方
- 每个句子是否有分量

阅读整个文档并提供反馈。

**当所有部分都已起草和完善后：**
宣布所有部分都已起草。表明打算再审查一次完整文档。

审查整体连贯性、流程、完整性。

提供任何最终建议。

询问是否准备好进入读者测试，或者他们是否想完善其他内容。

## 阶段3：读者测试

**目标：** 用新的大型语言模型（无上下文泄漏）测试文档，验证它对读者是否有效。

**对用户的说明：**
解释现在将进行测试，看看文档是否对读者真正有效。这可以发现盲点——作者理解但可能让其他人感到困惑的内容。

### 测试方法

**如果可以访问子代理（例如在大型语言模型 Code中）：**

直接进行测试，无需用户参与。

### 第1步：预测读者问题

宣布预测读者在尝试发现此文档时可能提出问题的意图。

生成读者可能会现实提出的5-10个问题。

### 第2步：用子代理测试

宣布这些问题将用新的大型语言模型实例（没有此对话的上下文）进行测试。

对于每个问题，使用只有文档内容和问题来调用子代理。

总结读者大型语言模型每个问题答对了/答错了什么。

### 第3步：运行额外检查

宣布将进行额外检查。

调用子代理检查歧义、错误假设、矛盾。

总结发现的任何问题。

### 第4步：报告和修复

如果发现问题：
报告读者大型语言模型在具体问题上遇到了困难。

列出具体问题。

表明意图修复这些差距。

回退到问题部分的完善。

---

**如果没有访问子代理的权限（例如大型语言模型.ai网页界面）：**

用户需要手动进行测试。

### 第1步：预测读者问题

询问人们在尝试发现此文档时可能会问什么问题。他们会在大型语言模型.ai中输入什么？

生成读者可能会现实提出的5-10个问题。

### 第2步：设置测试

提供测试说明：
1. 打开新的大型语言模型对话：https://大型语言模型.ai
2. 粘贴或分享文档内容（如果使用启用了连接器的共享文档平台，提供链接）
3. 向读者大型语言模型提出生成的问题

对于每个问题，指导读者大型语言模型提供：
- 答案
- 是否有任何歧义或不清楚的地方
- 文档假设已经知道什么知识/上下文

检查读者大型语言模型是否给出正确答案或误解了什么。

### 第3步：额外检查

还询问读者大型语言模型：
- "本文档中什么可能对读者来说歧义或不清楚？"
- "本文档假设读者已经具有什么知识或上下文？"
- "是否有任何内部矛盾或不一致？"

### 第4步：根据结果迭代

询问读者大型语言模型答错了或遇到了什么困难。表明意图修复这些差距。

对于任何有问题的部分回退到完善。

---

### 退出条件（两种方法）

当读者大型语言模型持续正确回答问题且没有发现新的差距或歧义时，文档就准备好了。

## 最终审查

当读者测试通过时：
宣布文档已通过读者大型语言模型测试。完成之前：

1. 建议他们自己进行最终通读——他们拥有此文档并对其质量负责
2. 建议仔细检查任何事实、链接或技术细节
3. 要求他们验证它是否实现了他们想要的影响

询问他们是否想要再一轮审查，或者工作是否完成。

**如果用户想要最终审查，提供它。否则：**
宣布文档完成。提供一些最终提示：
- 考虑在附录中链接此对话，以便读者可以看到文档是如何开发的
- 使用附录提供深度而不使主文档臃肿
- 根据来自实际读者的反馈更新文档

## 有效指导技巧

**语气：**
- 直接且程序化
- 当影响用户行为时简要解释原理
- 不要试图"推销"方法——只是执行它

**处理偏差：**
- 如果用户想要跳过阶段：询问他们是否想跳过这个并自由形式写作
- 如果用户似乎感到沮丧：承认这比预期要长。建议加快进度的方�
- 始终给予用户调整过程的自主权

**上下文管理：**
- 始终如一，如果提到的东西缺少上下文，主动询问
- 不要让差距积累——在出现时解决它们

**工件管理：**
- 使用`create_file`起草完整部分
- 使用`str_replace`进行所有编辑
- 每次更改后提供工件链接
- 永远不要将工件用于头脑风暴列表——那只是对话

**质量优先于速度：**
- 不要匆忙完成阶段
- 每次迭代都应该有意义的改进
- 目标是创建一个对读者真正有效的文档
